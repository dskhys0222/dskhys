# 要件定義：株式ポートフォリオ管理アプリ（Portfolio）

## 目的

保有している株式銘柄の情報を一元管理し、スマートフォンから簡単にポートフォリオ状況を確認できるようにする。

## 対象範囲

- クライアント：`packages/client/portfolio`（新規作成）

## 機能要件

### 1. 銘柄データの管理

#### 1.1 銘柄情報の入力・編集

- 以下の情報を入力・保存できる：
  - ティッカーシンボル（例：ACWI、VTI）
  - 銘柄名
  - 保有株数
  - 取得単価
  - 現在価格
  - カテゴリ情報：
    - アセットクラス（株式、債券など）
    - インデックス（S&P500、NASDAQ、MSCIなど）
    - 地域/国（日本株/投信、米国株/ETXなど）
    - 中分類（日本高配当、米国高配当、全世界株式など）
    - 小分類
  - 口座種別（課税、一般NISA、つみたてNISAなど）
  - 年間配当額
  - 配当利回り
  - 特定口座損益

#### 1.2 銘柄データの一覧表示

- 保有銘柄を一覧表示
- ソート機能（評価額、損益率など）
- フィルタ機能（口座種別、アセットクラスなど）

### 2. 集計・分析機能

#### 2.1 評価額・損益の集計

- 各銘柄の評価額を自動計算（保有株数 × 現在価格）
- 各銘柄の評価損益を自動計算（評価額 - (保有株数 × 取得単価)）
- 損益率を自動計算
- 合計評価額、合計損益、全体損益率を表示

#### 2.2 配当情報の集計

- 年間配当額の合計
- 配当利回りの算出

#### 2.3 各種サマリービュー

- アセットクラス別集計
- インデックス別集計
- 口座種別集計
- 中分類集計
- 小分類集計

### 3. ビジュアライゼーション（グラフ表示）

#### 3.1 理想のアセットアロケーション（円グラフ）

- ユーザーが設定した理想のアセット配分を表示
- カテゴリごとの目標比率を表示

#### 3.2 現在のアセットアロケーション（円グラフ）

- 実際の保有資産の配分を表示
- カテゴリごとの現在比率を表示

#### 3.3 現在のアセットアロケーション（インデックス除く）

- インデックスを除いた資産のみの配分を表示

#### 3.4 中分類別アロケーション（円グラフ）

- 理想と実際の2つの円グラフを表示

#### 3.5 口座種別アロケーション（円グラフ）

- 口座種別ごとの資産配分を表示

### 4. データ永続化

- ローカルストレージにデータを保存
- PWAとしてオフラインでも利用可能

### 5. データのインポート/エクスポート

- JSON形式でのデータエクスポート
- JSON形式でのデータインポート
- バックアップ・復元機能

## 前提・制約

- 完全にローカルで動作するPWA
- サーバーサイドとの連携なし
- 株価の自動取得機能は含まない（手動入力のみ）
- 初期リリースでは日本語UIのみ

## 非機能要件

### パフォーマンス

- 100銘柄程度の管理でも快適に動作すること
- グラフの描画は1秒以内に完了すること

### ユーザビリティ

- スマートフォンでの操作を最優先に設計
- タブレットでも見やすいレスポンシブデザイン
- 直感的なUI/UX

### セキュリティ

- ローカルストレージのデータは暗号化しない（ローカル専用のため）
- 外部への通信は行わない

### 保守性

- budgetプロジェクトと同様の技術スタックを使用
- コンポーネントの再利用性を考慮

## 画面構成（概要）

1. ホーム画面（ダッシュボード）
   - サマリー情報表示
   - 各種グラフ表示

2. 銘柄一覧画面
   - 保有銘柄のリスト表示
   - ソート・フィルタ機能

3. 銘柄追加/編集画面
   - 銘柄情報の入力フォーム

4. 集計・分析画面
   - 各種カテゴリ別の集計結果
   - 詳細グラフ

5. 設定画面
   - 理想のアロケーション設定
   - データのインポート/エクスポート

## 参考

- 既存プロジェクト：`packages/client/budget`
- スプレッドシートのレイアウトを参考にUI設計を行う
